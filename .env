# TestDriver MCP Framework v2.0 - Environment Configuration
# Copy this file to .env and update with your values

# ============================================================
# DATABASE CONFIGURATION
# ============================================================

# PostgreSQL (Recommended for Production)
# DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/testdriver

# SQLite (Good for Local Development)
DATABASE_URL=sqlite+aiosqlite:///./testdriver.db

# Database Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30


# ============================================================
# VISION API CONFIGURATION (Choose one or configure multiple)
# ============================================================

# OpenAI GPT-4V (Recommended for best accuracy)
# OPENAI_API_KEY=your_openai_api_key_here
# OPENAI_MODEL=gpt-4-vision-preview
# OPENAI_MAX_TOKENS=4096
# OPENAI_TEMPERATURE=0.1

# Anthropic Claude (Alternative vision API)
# ANTHROPIC_API_KEY=your_anthropic_api_key_here
# ANTHROPIC_MODEL=claude-3-opus-20240229

# Ollama (Local VLM - No API key needed)
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llava:13b

# Default Vision Provider
DEFAULT_VISION_PROVIDER=ollama


# ============================================================
# EXECUTION FRAMEWORK CONFIGURATION
# ============================================================

# Default browser driver (playwright or selenium)
DEFAULT_BROWSER_DRIVER=playwright

# Browser settings
DEFAULT_BROWSER=chromium
HEADLESS_MODE=false
BROWSER_TIMEOUT=30000
PAGE_LOAD_TIMEOUT=60000

# Screenshot settings
SCREENSHOT_ON_FAILURE=true
SCREENSHOT_QUALITY=90
SCREENSHOT_DIR=./screenshots


# ============================================================
# VECTOR STORE CONFIGURATION (Qdrant)
# ============================================================

# Qdrant URL (use :memory: for in-memory, or http://localhost:6333 for server)
QDRANT_URL=:memory:
QDRANT_COLLECTION=testdriver_elements
QDRANT_VECTOR_SIZE=384
QDRANT_DISTANCE=Cosine

# Qdrant API Key (if using cloud)
# QDRANT_API_KEY=your_qdrant_api_key_here


# ============================================================
# SELF-HEALING CONFIGURATION
# ============================================================

# Healing confidence threshold (0.0-1.0)
HEALING_CONFIDENCE_THRESHOLD=0.85

# Maximum healing attempts per element
MAX_HEALING_ATTEMPTS=3

# Healing strategy priority
HEALING_STRATEGIES=ai_vision,semantic_similarity,xpath_fuzzy,css_fuzzy

# Auto-create pull requests for healed tests
AUTO_CREATE_PR=true
GITHUB_TOKEN=your_github_token_here


# ============================================================
# LEARNING & OPTIMIZATION
# ============================================================

# Enable continuous learning
ENABLE_LEARNING=true

# Learning update interval (seconds)
LEARNING_UPDATE_INTERVAL=300

# Minimum samples for optimization
MIN_SAMPLES_FOR_OPTIMIZATION=20


# ============================================================
# MONITORING & OBSERVABILITY
# ============================================================

# Prometheus metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=./logs/testdriver.log

# Health check
HEALTH_CHECK_INTERVAL=60


# ============================================================
# MCP SERVER CONFIGURATION
# ============================================================

# Server settings
MCP_HOST=0.0.0.0
MCP_PORT=8000
MCP_WORKERS=4

# Server info
SERVER_NAME=testdriver-mcp
SERVER_VERSION=2.0.0
PROTOCOL_VERSION=2025-06-18


# ============================================================
# SECURITY & TESTING
# ============================================================

# Security scanning
ENABLE_SECURITY_TESTS=true
SQL_INJECTION_TEST=true
XSS_TEST=true
AUTH_BYPASS_TEST=false

# Performance testing
ENABLE_PERFORMANCE_TESTS=false
MAX_CONCURRENT_USERS=10
PERFORMANCE_TEST_DURATION=60


# ============================================================
# CROSS-LAYER VALIDATION
# ============================================================

# Enable cross-layer validation
ENABLE_CROSS_LAYER=true

# API validation settings
API_BASE_URL=http://localhost:3000/api
API_TIMEOUT=10000

# Database validation
DB_VALIDATION_ENABLED=true


# ============================================================
# RETRY & RESILIENCE
# ============================================================

# Retry settings
MAX_RETRIES=3
RETRY_DELAY=1000
EXPONENTIAL_BACKOFF=true

# Timeout settings
ELEMENT_WAIT_TIMEOUT=10000
ACTION_TIMEOUT=5000


# ============================================================
# DOCKER & DEPLOYMENT
# ============================================================

# Container settings
DOCKER_NETWORK=testdriver-network
COMPOSE_PROJECT_NAME=testdriver

# Resource limits
MEMORY_LIMIT=4g
CPU_LIMIT=2.0
AI_PROVIDER=ollama-cloud
AI_API_URL=https://ollama.com
AI_API_KEY=your_ai_api_key_here
AI_MODEL=gemini-3-pro-preview
